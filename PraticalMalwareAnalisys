- WinMD5 -> GUI calculate hash
- md5deep [file] -> command line calculate hash
- Strings program (http://bit.ly/ic4plL)
- Packed and obfuscated code will often include at least the functions LoadLibrary and GetProcAddress
- Unpack (upx -d file.exe) http://upx.sourceforge.net/

---- Several Microsoft Windows functions allow programmers to import
linked functions not listed in a program’s file header. Of these, the two most
commonly used are LoadLibrary and GetProcAddress. LdrGetProcAddress and
LdrLoadDll are also used. LoadLibrary and GetProcAddress allow a program to
access any function in any library on the system, which means that when
these functions are used, you can’t tell statically which functions are being
linked to by the suspect program. ----

- The Dependency Walker list only dinamically linked functions executable. http://www.dependencywalker.com/
- Common DLLs (Kernel32.dll, Advapi32.dll, User32.dll, Gdi32.dll, Ntdll.dll, WSock32.dll and
Ws2_32.dll, Wininet.dll.
- New functions suffix ex (Ex. ABCDEFex) and old functions continues support.
- Many functions that take strings as parameters include an A or a W at the end (one for ASCII strings and
one for wide character strings)

- GDI32.dll, SetWindowsHookEx indicate possible keylogging.
- Software\Microsoft\Windows\CurrentVersion\Run (commonly used by malware) controls which programs are automatically run when Windows starts up.
- PE file : 
.text = section contains the instructions that the CPU executes. 
.rdata = import and export information.
.data = programs global data.
.rsrc = resources used by exe, are not considere part of the exe.
.idata Sometimes present and stores the import function information; if this section is not present, the import function information is stored in the .rdata section.
.edata Sometimes present and stores the export function information; if this section is not present, the export function information is stored in the .rdata section.
.pdata Present only in 64-bit executables and stores exception-handling information.
.reloc Contains information for relocation of library files.

- PE file tools (PEView, Resource Hacker, PEBrowse, PEExplorer)
- WS2_32.dll  provides network functionality
- DLL malware may also need to be installed as a service, sometimes with aconvenient export such as InstallService.
- ProcMon - important filters for malware analysis are Process Name, Operation, and Detail.
- microprocessors - x86,x64, SPARC, PowerPC, MIPS, and ARM.
- main memory - data, code, heap, stack
- EAX - if you see the EAX register used immediately after a function call, you are probably seeing the code manipulate the return value.
- EFLAGS - ZF, CF, SF, TF.
- pusha pushes the 16-bit registers on the stack in the following order: AX, CX, DX, BX, SP, BP, SI, DI.
- pushad pushes the 32-bit registers on the stack in the following order: EAX, ECX, EDX, EBX, ESP, EBP, ESI, EDI.
- BOF - The most common data buffer manipulation instructions are movsx, cmpsx, stosx, and scasx, where x = b, w, or d for byte, word, or double word, respectively.
- CheckResult - Identify while condition
- The most commonly encountered request for a malicious kernel compo- nent is DeviceIoControl, which is a generic request from a user-space module to a device managed by a driver.
- Malicious drivers generally do not usually control hardware; instead, they interact with the main Windows kernel components, ntoskrnl.exe and hal.dll. The ntoskrnl.exe component has the code for the core OS functions, and hal.dll has the code for interacting with the main hardware components. Malware will often import functions from one or both of these files in order to manipulate the kernel.
- For example, if you want to look at disassembly of the NtCreateProcess function in ntoskrnl.exe, you would use the disassemble com- mand u (which stands for unassemble) with the parameter nt!NtCreateProcess. If you don’t specify a library name, WinDbg will search through all of the loaded modules for a matching symbol. This can take a long time because
it must load and search symbols for every module.
- The command x nt!*CreateProcess* will display exported functions as well as internal functions. The following is the output for x nt!*CreateProcess*. #WINDBG
- Another useful command is the ln command, which will list the closest symbol for a given memory address. #WINDBG

- When configured properly, WinDbg will query Microsoft’s server and automatically get the correct symbols for the files that are currently being debugged. You can set the symbol file path by selecting FileSymbol File Path. To configure WinDbg to use the online symbol server, enter the following path:
SRV*c:\websymbols*http://msdl.microsoft.com/download/symbols 
- Kernel modules are not loaded and unloaded often, so if you are debugging your malware and a kernel module is loaded, then you should be suspicious of the module.
- You can use the !devobj command to get device object information by using the name of the device specified by the CreateFile call from the user-space code.
- If you need to load an unsigned driver on an x64 Vista system, you can use the BCDEdit utility to modify the boot options. Specifically, nointegritychecks disables the requirement that drivers be signed.
